begin model

begin parameters
  A_i 100
  B_i 150

  kon222 1e8/NA_um3
  koff 1e-2

  ITERATIONS 1e2
  
  D_VOL 1e-4 # cm^2/s
  D_SURF 1e-8 # cm^2/s
  MCELL_DIFFUSION_CONSTANT_3D_A D_VOL
  MCELL_DIFFUSION_CONSTANT_3D_B D_VOL
  MCELL_DIFFUSION_CONSTANT_3D_C D_VOL
  VolCP 0.50588 
  VolPM 0.0307 # from volume of 0.505 r = 0.494 and area = 3.07um2 * 0.01um thickness. Assuming a thickness of 0.01 microns for the PM
  NA_um3 6.022e8 # Avogadro's number mutiplied by 1e-15 since we are using volume units of microns(^-3)
  VOL_RXN 1
  MCELL_REDEFINE_NA_um3 VOL_RXN # In MCell the units get multiplied by V_RXN so they stay the same

end parameters

begin molecule types
    A(b)
    B(a)
    C()
end molecule types

begin compartments
 	PM 2 VolPM #2Dimensions, surface compartment
 	CP 3 VolCP PM #3Dimensions and 1 microcubic in volume, volume compartment
 	# http://www.lehman.edu/academics/cmacs/documents/RuleBasedPrimer-2011.pdf
end compartments

begin seed species
    A(b)@PM A_i 
    B(a)@CP B_i
end seed species

begin observables
    Molecules A A(b)
    Molecules B B(a)
    Molecules C C()
end observables


begin reaction rules
    # Reaction between A in PM and B in PM
    A(b)@PM + B(a)@CP <-> A(b)@PM + C()@CP kon222, koff

end reaction rules

end model
simulate({method=>"ssa",t_end=>"ITERATIONS",n_steps=>10})